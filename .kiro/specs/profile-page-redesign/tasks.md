# 実装タスクリスト

- [x] 1. 型定義とデータ構造の整備
  - 既存の`src/features/profile/types/index.ts`を新しい要件に合わせて更新
  - 不要な型（ProfilePost、ProfileStats、フォロー関連）を削除
  - 新しい型（EditUsernameData、EditIconData、TechnologySelectorProps）を追加
  - Server Actions用の結果型を定義
  - _要件: 1.1, 2.1, 3.1, 4.1_

- [x] 2. Server Actionsの実装
  - `src/app/actions/profile.ts`を作成
  - _要件: 2.1, 2.2, 2.3, 3.1, 3.2, 4.1, 4.2, 5.1, 6.1, 6.2, 6.3_

- [x] 2.1 ユーザー名更新アクションの実装
  - セッション検証を実装
  - ユーザー名のバリデーション（空文字、重複チェック）
  - Prismaでユーザー名を更新
  - エラーハンドリングと結果の返却
  - _要件: 2.2, 2.3, 2.4, 2.5_

- [x] 2.2 アイコン更新アクションの実装
  - セッション検証を実装
  - Prismaでアイコンを更新
  - エラーハンドリングと結果の返却
  - _要件: 3.2, 3.3, 3.4_

- [x] 2.3 技術スタック更新アクションの実装
  - セッション検証を実装
  - 既存のUserTechnologyレコードを削除
  - 新しいUserTechnologyレコードを作成
  - エラーハンドリングと結果の返却
  - _要件: 4.2, 4.3, 4.4, 4.5_

- [x] 2.4 アカウント削除アクションの実装
  - セッション検証を実装
  - Prismaでユーザーを削除（Cascade削除により関連データも削除）
  - Better Authのセッションを無効化
  - エラーハンドリングと結果の返却
  - _要件: 6.3, 6.4, 6.5, 6.6_

- [x] 3. プロフィールヘッダーコンポーネントの実装
  - `src/features/profile/components/profile-header.tsx`を作成
  - _要件: 1.1, 1.2, 2.1, 3.1_

- [x] 3.1 基本的なヘッダーUIの実装
  - プロフィールアイコンの表示（デフォルトアイコン対応）
  - ユーザー名の表示
  - 編集ボタン（アイコン、ユーザー名）の配置
  - _要件: 1.1, 1.2_

- [x] 3.2 Storybookストーリーの作成
  - `profile-header.stories.tsx`を作成
  - デフォルトアイコンの状態
  - カスタムアイコンの状態
  - ユーザー名あり/なしの状態
  - _要件: 1.1, 1.2_

- [x] 4. ユーザー名編集ダイアログの実装
  - `src/features/profile/components/edit-username-dialog.tsx`を作成
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 4.1 ダイアログUIとフォームの実装
  - Shadcn UIのDialogコンポーネントを使用
  - 入力フィールドに現在のユーザー名を表示
  - バリデーション（空文字チェック、文字数制限）
  - 保存ボタンとキャンセルボタン
  - _要件: 2.1, 2.2_

- [x] 4.2 Server Actionとの連携
  - updateUsername Server Actionを呼び出し
  - ローディング状態の表示
  - 成功時のトーストメッセージ
  - エラー時のエラーメッセージ表示
  - _要件: 2.3, 2.4, 2.5_

- [x] 4.3 Storybookストーリーの作成
  - `edit-username-dialog.stories.tsx`を作成
  - 開いた状態/閉じた状態
  - バリデーションエラーの状態
  - 保存中の状態
  - _要件: 2.1, 2.2, 2.5_

- [x] 5. アイコン編集ダイアログの実装
  - `src/features/profile/components/edit-icon-dialog.tsx`を作成
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [x] 5.1 ダイアログUIとアイコン選択の実装
  - Shadcn UIのDialogコンポーネントを使用
  - プリセットアイコンの一覧表示
  - アイコン選択UI
  - プレビュー表示
  - _要件: 3.1, 3.3_

- [x] 5.2 Server Actionとの連携
  - updateIcon Server Actionを呼び出し
  - ローディング状態の表示
  - 成功時のトーストメッセージ
  - エラー時のエラーメッセージ表示
  - _要件: 3.2, 3.3, 3.4_

- [x] 5.3 Storybookストーリーの作成
  - `edit-icon-dialog.stories.tsx`を作成
  - 開いた状態/閉じた状態
  - アイコン選択の状態
  - 保存中の状態
  - _要件: 3.1, 3.3, 3.4_

- [x] 6. 技術スタックセクションの実装
  - `src/features/profile/components/profile-info-section.tsx`を作成
  - _要件: 1.3, 4.1_

- [x] 6.1 技術スタック表示UIの実装
  - 技術タグの表示
  - 編集ボタンの配置
  - 空の状態の表示
  - _要件: 1.3_

- [x] 6.2 Storybookストーリーの作成
  - `profile-info-section.stories.tsx`を作成
  - 技術が選択された状態
  - 空の状態
  - _要件: 1.3_

- [x] 7. 技術スタック選択UIの実装
  - `src/features/profile/components/technology-selector.tsx`を作成
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 7.1 選択UIとフィルター機能の実装
  - 利用可能な技術の一覧表示
  - 検索/フィルター機能
  - 選択/解除機能
  - 選択済み技術の表示
  - _要件: 4.1, 4.2, 4.3_

- [x] 7.2 Server Actionとの連携
  - updateTechnologies Server Actionを呼び出し
  - ローディング状態の表示
  - 成功時のトーストメッセージ
  - エラー時のエラーメッセージ表示
  - _要件: 4.4, 4.5_

- [x] 7.3 Storybookストーリーの作成
  - `technology-selector.stories.tsx`を作成
  - 空の状態
  - 技術が選択された状態
  - 検索中の状態
  - _要件: 4.1, 4.2, 4.3_

- [x] 8. アカウント操作コンポーネントの実装
  - `src/features/profile/components/account-actions.tsx`を作成
  - _要件: 5.1, 6.1_

- [x] 8.1 ログアウトと退会ボタンの実装
  - ログアウトボタンの配置
  - 退会ボタンの配置（デストラクティブスタイル）
  - ボタンクリック時のハンドラー
  - _要件: 5.1, 6.1_

- [x] 8.2 Storybookストーリーの作成
  - `account-actions.stories.tsx`を作成
  - デフォルト状態
  - ボタンのホバー状態
  - _要件: 5.1, 6.1_

- [x] 9. ログアウト機能の実装
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [x] 9.1 ログアウト確認ダイアログの実装
  - 確認ダイアログの表示
  - Better Auth signOut APIの呼び出し
  - ログインページへのリダイレクト
  - _要件: 5.1, 5.2, 5.3_

- [x] 10. アカウント削除ダイアログの実装
  - `src/features/profile/components/delete-account-dialog.tsx`を作成
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_

- [x] 10.1 ダイアログUIと二重確認の実装
  - 警告メッセージの表示
  - 二次確認（テキスト入力による確認）
  - 削除ボタン（デストラクティブスタイル）
  - _要件: 6.1, 6.2_

- [x] 10.2 Server Actionとの連携
  - deleteAccount Server Actionを呼び出し
  - ローディング状態の表示
  - 成功時のホームページへのリダイレクト
  - エラー時のエラーメッセージ表示
  - _要件: 6.3, 6.4, 6.5, 6.6_

- [x] 10.3 Storybookストーリーの作成
  - `delete-account-dialog.stories.tsx`を作成
  - 開いた状態/閉じた状態
  - 二次確認の状態
  - 削除中の状態
  - エラー状態
  - _要件: 6.1, 6.2, 6.6_

- [x] 11. プロフィールページの統合
  - `src/app/profile/page.tsx`を更新
  - _要件: 1.1, 1.2, 1.3, 1.4, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

- [x] 11.1 Server Componentの実装
  - セッション取得と認証チェック
  - 未認証時のログインページへのリダイレクト
  - ユーザー情報と技術スタックの取得
  - Client Componentへのデータ渡し
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 11.2 Client Componentの実装
  - `src/app/profile/client-profile.tsx`を作成
  - 各コンポーネントの統合
  - ダイアログの状態管理
  - revalidatePathによるキャッシュ無効化
  - _要件: 1.1, 1.2, 1.3_

- [x] 11.3 レイアウトとスタイリングの調整
  - レスポンシブデザインの実装
  - 中央寄せレイアウト（最大幅600px）
  - セクション間のスペーシング
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

- [x] 12. 既存コードのクリーンアップ
  - 不要なコンポーネントの削除
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

- [x] 12.1 不要なコンポーネントとファイルの削除
  - `profile-demo.tsx`の削除
  - `profile.tsx`の削除（いいね、ブックマーク一覧関連）
  - `profile-edit-dialog.tsx`の削除
  - 不要なサンプルデータの削除
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 12.2 型定義のクリーンアップ
  - 不要な型の削除（ProfilePost、ProfileStats、フォロー関連）
  - 使用されていないインポートの削除
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5_
